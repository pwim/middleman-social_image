# Middleman::SocialImage

Use HTML and CSS to dynamically generate static images for Open Graph (Facebook, LinkedIn) and Twitter cards in a Middleman application. Image is generated by using Google Chrome in headless mode to screenshot a page served by middleman. Originally created for [tokyodev](https://www.tokyodev.com/), which lists internationally-friendly software developer jobs in Japan.

## Installation

Add this line to your application's Gemfile:

    gem 'middleman-social_image'

And then execute:

    $ bundle

## Usage

You need to add the following code to your ```config.rb``` file:

```ruby
activate :social_image
```

Optionally, you can configure this extension with the following (defaults are shown):

```ruby
activate :social_image do |social_image|
  social_image.window_size = '1200,600' # The size of the screenshot
  social_image.selector = 'body > *' # Used to test that the social image url has loaded properly. The more specific this is, the better the chance of catching errors.
  social_image.always_generate = true # Always regenerate images. Takes a long time, but ensures any changes are reflected.
  social_image.parallel = true # Generate images in parallel.
end
```

Create a HTML page in your middleman app that contains the HTML you want to be rendered. Add `social_image: true` to the page's front matter to indicate it is the source for a social image. You can also add it as an option if you're using a proxy page like the following.

``` ruby
["tom", "dick", "harry"].each do |name|
  proxy "/social-image/#{name}.html", "/templates/social-image.html", social_image: true, locals: { name: name }
end
```

You can now refer to this image as normal within your middleman application.

In preview mode, you don't need any other special setup. However, to generate the images in build, you also need to be running the preview server with `bundle exec middleman server`.
